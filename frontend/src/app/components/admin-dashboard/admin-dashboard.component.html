<div class="admin-container">
    <div class="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-shield-alt logo-icon"></i>
            <h2>Admin Panel</h2>
        </div>

        <nav class="sidebar-nav">
            <button [class.active]="activeTab === 'companies'" (click)="setActiveTab('companies')">
                <i class="fas fa-building"></i> Empresas
            </button>
            <button [class.active]="activeTab === 'assign'" (click)="setActiveTab('assign')">
                <i class="fas fa-link"></i> Asignar Usuario
            </button>
        </nav>
    </div>

    <div class="main-content">
        <!-- HEADER -->
        <header class="top-bar">
            <h1>Gestión Administrativa</h1>
            <div class="user-info">
                <span>Administrador</span>
                <div class="avatar-small">A</div>
            </div>
        </header>

        <!-- CONTENT -->
        <div class="content-wrapper">

            <!-- ALERTS -->
            <div *ngIf="successMessage" class="alert success">
                <i class="fas fa-check-circle"></i> {{ successMessage }}
            </div>
            <div *ngIf="errorMessage" class="alert error">
                <i class="fas fa-exclamation-triangle"></i> {{ errorMessage }}
            </div>

            <!-- TAB: COMPANIES -->
            <div *ngIf="activeTab === 'companies'" class="tab-pane fade-in">

                <div class="two-column-grid">
                    <!-- Create Company Form -->
                    <div class="admin-card">
                        <h3><i class="fas fa-plus-circle"></i> Crear Nueva Empresa</h3>
                        <form [formGroup]="companyForm" (ngSubmit)="createCompany()">
                            <div class="form-group">
                                <label>RUC</label>
                                <div class="input-icon">
                                    <i class="fas fa-id-card"></i>
                                    <input formControlName="ruc" type="text" placeholder="20123456789">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Nombre Comercial</label>
                                <div class="input-icon">
                                    <i class="fas fa-store"></i>
                                    <input formControlName="nombreEmpresa" type="text"
                                        placeholder="Ej. Transportes Civa">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Razón Social</label>
                                <div class="input-icon">
                                    <i class="fas fa-file-contract"></i>
                                    <input formControlName="razonSocial" type="text">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Teléfono</label>
                                <div class="input-icon">
                                    <i class="fas fa-phone"></i>
                                    <input formControlName="telefonoEmpresa" type="text" placeholder="987654321">
                                </div>
                            </div>
                            <button type="submit" [disabled]="companyForm.invalid" class="btn-primary full-width">
                                Crear Empresa
                            </button>
                        </form>
                    </div>

                    <!-- Companies List -->
                    <div class="admin-card">
                        <h3><i class="fas fa-list"></i> Empresas Registradas</h3>
                        <div class="company-list">
                            <div class="company-item" *ngFor="let emp of empresas"
                                (click)="viewCompanyDetails(emp.idEmpresaTransporte)" style="cursor:pointer">
                                <div class="company-icon">
                                    <i class="fas fa-bus"></i>
                                </div>
                                <div class="company-info">
                                    <h4>{{emp.nombreEmpresa}}</h4>
                                    <span>RUC: {{emp.ruc}}</span>
                                </div>
                                <span class="badge">Activo</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB: ASSIGN -->
            <div *ngIf="activeTab === 'assign'" class="tab-pane fade-in">
                <div class="admin-card centered-card">
                    <h3><i class="fas fa-user-plus"></i> Asignar Usuario a Empresa</h3>
                    <p class="card-desc">Vincula un usuario registrado a una empresa de transporte.</p>

                    <!-- Search Step -->
                    <div class="search-section">
                        <div class="search-bar">
                            <input type="text" [(ngModel)]="searchDni" placeholder="Buscar usuario por DNI"
                                [ngModelOptions]="{standalone: true}">
                            <button (click)="searchUser()"><i class="fas fa-search"></i></button>
                        </div>
                    </div>

                    <!-- User Found -->
                    <div *ngIf="searchedUser" class="user-result-card">
                        <div class="user-avatar">
                            {{ searchedUser.nombre_usuario.substring(0,2).toUpperCase() }}
                        </div>
                        <div class="user-details">
                            <h4>{{ searchedUser.nombre_usuario }}</h4>
                            <p>{{ searchedUser.apPaterno }} {{ searchedUser.apMaterno }}</p>
                            <span class="role-badge">{{ searchedUser.nombreTipoUsuario }}</span>
                        </div>
                    </div>

                    <!-- Assign Form -->
                    <form *ngIf="searchedUser" [formGroup]="assignForm" (ngSubmit)="assignCompany()"
                        class="assign-form">
                        <input type="hidden" formControlName="idUsuario">

                        <div class="form-group">
                            <label>Seleccionar Empresa</label>
                            <div class="input-icon">
                                <i class="fas fa-building"></i>
                                <select formControlName="idEmpresa">
                                    <option value="" disabled selected>-- Seleccione --</option>
                                    <option *ngFor="let emp of empresas" [value]="emp.idEmpresaTransporte">
                                        {{ emp.nombreEmpresa }}
                                    </option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" [disabled]="assignForm.invalid" class="btn-primary full-width">Confirmar
                            Asignación</button>
                    </form>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- DETAILS MODAL -->
<div class="modal-overlay" *ngIf="showDetailsModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3><i class="fas fa-info-circle"></i> {{selectedCompanyDetails?.nombreEmpresa}}</h3>
            <button (click)="closeModal()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <div class="detail-group">
                <p><strong>RUC:</strong> {{selectedCompanyDetails?.ruc}}</p>
                <p><strong>Razón Social:</strong> {{selectedCompanyDetails?.razonSocial || '-'}}</p>
                <p><strong>Teléfono:</strong> {{selectedCompanyDetails?.telefonoEmpresa || '-'}}</p>
            </div>

            <div class="assigned-admin-box">
                <h4><i class="fas fa-user-shield"></i> Administrador Asignado</h4>
                <div *ngIf="selectedCompanyDetails?.usuarioAsignado; else noUser">
                    <p class="admin-name">{{selectedCompanyDetails?.usuarioAsignado}}</p>
                    <p class="admin-email"><i class="fas fa-envelope"></i> {{selectedCompanyDetails?.correoUsuario}}</p>
                </div>
                <ng-template #noUser>
                    <p class="text-muted">No hay usuario asignado.</p>
                </ng-template>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-id-card"></i>
                    <div class="stat-info">
                        <span>{{selectedCompanyDetails?.numConductores}}</span>
                        <p>Conductores</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-bus"></i>
                    <div class="stat-info">
                        <span>{{selectedCompanyDetails?.numVehiculos}}</span>
                        <p>Vehículos</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
```